"use strict";function _createForOfIteratorHelper(e,t){var r,n,o,a,c="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(c)return n=!(r=!0),{s:function(){c=c.call(e)},n:function(){var e=c.next();return r=e.done,e},e:function(e){n=!0,o=e},f:function(){try{r||null==c.return||c.return()}finally{if(n)throw o}}};if(Array.isArray(e)||(c=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return c&&(e=c),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var parse=function(e){return espree.parse(e,{ecmaVersion:"latest"})},config={format:{useNewLine:!0,semi:!0,indent:4,leftSpace:!0,commaSpace:!0,semiSpace:!0,colonSpace:!0,forSpace:!1,ifSpace:!0,whileSpace:!0,operatorSpace:!0,functionSapce:!0,arrowFunctionSapce:!0,methodFunctionSapce:!0,updateSpace:!0,classSapce:!1}},FormatterConfig=_createClass(function e(){_classCallCheck(this,e)}),hasArray=(_defineProperty(FormatterConfig,"codeSpaceType",{ForStatement:"forSpace",IfStatement:"ifSpace",WhileStatement:"whileSpace",operatorSpace:"operatorSpace",LogicalExpression:"logicalSpace",FunctionExpression:"functionSapce",ArrowFunctionExpression:"arrowFunctionSapce",MethodDefinition:"methodFunctionSapce",ClassDeclaration:"classSapce",defaultSpace:"defaultSpace",UpdateExpression:"updateSpace"}),_defineProperty(FormatterConfig,"space",function(e){return config.format[e]?" ":""}),_defineProperty(FormatterConfig,"isNewLine",function(){return config.format.useNewLine?(config.format.semi=!0,"\n"):""}),_defineProperty(FormatterConfig,"tab",function(){return config.format.useNewLine?" ".repeat(config.format.indent):""}),_defineProperty(FormatterConfig,"colon",function(){return config.format.colonSpace?": ":":"}),_defineProperty(FormatterConfig,"semicolon",function(){return config.format.semiSpace?"; ":";"}),_defineProperty(FormatterConfig,"comma",function(){return config.format.commaSpace?", ":","}),_defineProperty(FormatterConfig,"isSemi",function(){return config.format.semi?";":""}),function(e){return e.map(function(e){return"ArrayExpression"===e.type||"ObjectExpression"===e.type}).includes(!0)}),hasObject=function(e){return e.map(function(e){return"ObjectExpression"===e.value.type||"ArrayExpression"===e.value.type}).includes(!0)},codegenBlock=function(e){var t;return config.format.useNewLine?"".concat(t="\n")+e.split(t).map(function(e){return"".concat(FormatterConfig.tab()).concat(e)}).join("\n")+"\n":e},codegen=function e(t){var r,n,o,a,c,i,f=t.type;if("Program"==f)return a=FormatterConfig.isSemi()+FormatterConfig.isNewLine(),""+(t.body.map(e).join(a)+FormatterConfig.isSemi());if("Identifier"===f)return t.name;if("Literal"===f)return t.raw;if("BinaryExpression"===f)return a=e(t.left),o=e(t.right),n=FormatterConfig.space(FormatterConfig.codeSpaceType.operatorSpace),n="".concat(n).concat(t.operator).concat(n),"".concat(a).concat(n).concat(o);if("MemberExpression"===f)return a=e(t.object),n=e(t.property),t.computed?"".concat(a,"[").concat(n,"]"):"".concat(a,".").concat(n);if("ExpressionStatement"===f)return e(t.expression);if("CallExpression"===f)return o=e(t.callee),a=FormatterConfig.comma(),n=t.arguments.map(e).join(a),"".concat(o,"(").concat(n,")");if("LogicalExpression"===f)return a=e(t.left),o=e(t.right),n=FormatterConfig.space(FormatterConfig.codeSpaceType.operatorSpace),n="".concat(n).concat(t.operator).concat(n),"LogicalExpression"===t.right.type?"".concat(a).concat(n,"(").concat(o,")"):"".concat(a).concat(n).concat(o);if("ForStatement"===f)return a=e(t.init),n=e(t.test),o=e(t.update),i=e(t.body),c=FormatterConfig.semicolon(),r=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),"for".concat(r,"(").concat(a).concat(c).concat(n).concat(c).concat(o,")").concat(r,"{").concat(i,"}");if("VariableDeclaration"===f)return a=t.kind,n=FormatterConfig.comma(),c=t.declarations.map(e).join(n),"".concat(a," ").concat(c);if("VariableDeclarator"===f)return o=e(t.id),t.init?(r=e(t.init),i=FormatterConfig.space(FormatterConfig.codeSpaceType.operatorSpace),n="".concat(i,"=").concat(i),"".concat(o).concat(n).concat(r)):"".concat(o);if("UpdateExpression"===f)return a=t.operator,c=e(t.argument),i=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),"".concat(c).concat(i).concat(a);if("BlockStatement"===f)return n=FormatterConfig.isSemi()+FormatterConfig.isNewLine(),r="",r+=t.body.map(e).join(n)+FormatterConfig.isSemi(),codegenBlock(r);if("ArrayExpression"===f){if(hasArray(t.elements)&&config.format.useNewLine){var p,s="[\n",m=_createForOfIteratorHelper(t.elements);try{for(m.s();!(p=m.n()).done;)var u=p.value,s=s+e(u).split("\n").map(function(e){return"".concat(FormatterConfig.tab()).concat(e)}).join("\n")+",\n"}catch(e){m.e(e)}finally{m.f()}return s+="]"}return o=FormatterConfig.comma(),c=t.elements.map(e).join(o),"[".concat(c,"]")}if("ObjectExpression"===f){if(hasObject(t.properties)&&config.format.useNewLine){var l,g="{\n",y=_createForOfIteratorHelper(t.properties);try{for(y.s();!(l=y.n()).done;)var d=l.value,g=g+e(d).split("\n").map(function(e){return"".concat(FormatterConfig.tab()).concat(e)}).join("\n")+",\n"}catch(e){y.e(e)}finally{y.f()}return g+="}"}if(config.format.useNewLine){var F,S="{",C=_createForOfIteratorHelper(t.properties);try{for(C.s();!(F=C.n()).done;){var b=F.value,h=e(b);S+="".concat("\n").concat(FormatterConfig.tab())+h+FormatterConfig.comma()}}catch(e){C.e(e)}finally{C.f()}return S+="".concat("\n","}")}return i=FormatterConfig.comma(),a=t.properties.map(e).join(i),"{".concat(a,"}")}if("Property"===f)return n=e(t.key),r=e(t.value),"".concat(n).concat(FormatterConfig.colon()).concat(r);if("FunctionExpression"===f)return o=FormatterConfig.comma(),c=t.params.map(e).join(o),i=e(t.body),a=FormatterConfig.space(FormatterConfig.codeSpaceType.functionSapce),"function".concat(a,"(").concat(c,")").concat(a,"{").concat(i,"}");if("NewExpression"===f)return n=e(t.callee),r=FormatterConfig.comma(),o=t.arguments.map(e).join(r),"new ".concat(n,"(").concat(o,")");if("AssignmentExpression"===f)return c=e(t.left),a=e(t.right),i=FormatterConfig.space(FormatterConfig.codeSpaceType.operatorSpace),r="".concat(i).concat(t.operator).concat(i),"".concat(c).concat(r).concat(a);if("ReturnStatement"===f)return t.argument?(n=e(t.argument),"return ".concat(n)):"return";if("IfStatement"===f)return o=e(t.test),i=e(t.consequent),c=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),r="if".concat(c,"(").concat(o,")").concat(c,"{").concat(i,"}"),t.alternate&&(a=e(t.alternate),r+="".concat(c,"else ").concat(a)),r;if("ClassDeclaration"===f)return n=e(t.id),o=e(t.body),i=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),c="class ".concat(n),t.superClass&&(a=e(t.superClass),c+=" extends ".concat(a)),c+"".concat(i,"{").concat(o,"}");if("ClassBody"===f)return r=FormatterConfig.isSemi()+FormatterConfig.isNewLine(),n="",n+=t.body.map(e).join(r)+FormatterConfig.isSemi(),codegenBlock(n);if("MethodDefinition"===f)return a=e(t.key),c=FormatterConfig.comma(),i=t.value.params.map(e).join(c),o=e(t.value.body),r=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),n="".concat(a,"(").concat(i,")").concat(r,"{").concat(o,"}"),t.static?"static "+n:n;if("ThisExpression"===f)return"this";if("UnaryExpression"===f)return c=e(t.argument),a=t.operator,"".concat(a).concat(c);if("ArrowFunctionExpression"===f)return i=FormatterConfig.comma(),r=t.params.map(e).join(i),o=e(t.body),n=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),t.expression?"(".concat(r,")").concat(n,"=>").concat(n).concat(o):"(".concat(r,")").concat(n,"=>").concat(n,"{").concat(o,"}");if("RestElement"===f)return a=e(t.argument),"...".concat(a);if("SpreadElement"===f)return c=e(t.argument),"...".concat(c);if("Super"===f)return"super";if("TemplateLiteral"!==f)return"TemplateElement"===f?t.value.raw:"WhileStatement"==f?(i=e(t.test),r=e(t.body),n=FormatterConfig.space(FormatterConfig.codeSpaceType[f]),"while".concat(n,"(").concat(i,")").concat(n,"{").concat(r,"}")):"ForOfStatement"==f||"ForInStatement"==f?(o=e(t.left),a=e(t.right),c=e(t.body),i=FormatterConfig.space("forSpace"),"for".concat(i,"(").concat(o," ").concat({ForOfStatement:"of",ForInStatement:"in"}[f]," ").concat(a,")").concat(i,"{").concat(c,"}")):void log("还没有处理的type:\n",f);var v="`",w=[],E=t.quasis,x=t.expressions;w.push(E[0]);for(var j=0;j<E.length-1;j++){var _,T=E[j],A=E[j+1],L=_createForOfIteratorHelper(x);try{for(L.s();!(_=L.n()).done;){var O=_.value;O.start>T.start&&O.start<A.start&&(w.push(O),w.push(A))}}catch(e){L.e(e)}finally{L.f()}}for(var P=0,I=w;P<I.length;P++){var k=I[P];"TemplateElement"===k.type?v+=e(k):v+="${"+e(k)+"}"}return v+="`"},formatter=function(e,t){config.format=Object.assign(config.format,t);t=parse(e);return codegen(t)};