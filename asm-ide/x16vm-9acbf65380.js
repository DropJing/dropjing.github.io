"use strict";function _createForOfIteratorHelper(e,t){var r,i,s,a,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return i=!(r=!0),{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){i=!0,s=e},f:function(){try{r||null==n.return||n.return()}finally{if(i)throw s}}};if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var AxePU=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck(this,r),this.register={pa:0,a1:0,a2:0,a3:0,c1:0,f1:0},this.memory=[],this.initMemory(e),this.paList=t}return _createClass(r,[{key:"initMemory",value:function(e){this.memory=this.memory.concat(e);for(var t=e.length;t<65536;t+=1)this.memory.push(0)}},{key:"run",value:function(){for(;;)if(-1===this.runStep())break}},{key:"runPoint",value:function(){for(;;){var e,t=_createForOfIteratorHelper(this.paList);try{for(t.s();!(e=t.n()).done;)if(e.value.pa===this.register.pa)return}catch(e){t.e(e)}finally{t.f()}if(-1===this.runStep())break}}},{key:"runStep",value:function(){log("runStep");var e=this.memory,t=this.register,r=t.pa,i=e[r];if(0==i){var s=e[r+1],a=e[r+2];t.pa+=4,this.setRegister(s,a)}else if(1==i){a=e[r+1],s=e[r+2];t.pa+=4,this.setRegister(s,e[a])}else if(2==i){var n=e[r+1],o=e[r+2],l=e[r+3],a=(t.pa+=4,this.getRegister(n)+this.getRegister(o));this.setRegister(l,a)}else if(3==i){s=e[r+1],a=e[r+2];t.pa+=4,e[a]=this.getRegister(s)}else if(4==i){n=e[r+1],o=e[r+2];t.pa+=3;var u=0,u=(f=this.getRegister(n))<(g=this.getRegister(o))?0:f==g?1:2;this.register.c1=u}else if(5==i){var f=e[r+1],g=e[r+2];t.pa+=3,0==this.register.c1&&(t.pa=f+256*g)}else if(6==i){f=e[r+1],g=e[r+2];t.pa+=3,t.pa=f+256*g}else if(7==i){n=e[r+1],o=e[r+2],a=(t.pa+=3,this.getRegister(n));e[p=this.getRegister(o)]=a}else if(8==i){s=e[r+1],f=e[r+2],a=256*(g=e[r+3])+f;this.setRegister(s,a),t.pa+=4}else if(9==i){var h=e[r+1],c=e[r+2],p=this.calculateAddress(h,c),a=this.getAddressValue(p),s=e[r+3];this.setRegister(s,a),t.pa+=4}else if(10==i){n=e[r+1],o=e[r+2],l=e[r+3],a=(t.pa+=4,this.getRegister(n)+this.getRegister(o));this.setRegister(l,a)}else if(11==i){s=e[r+1],h=e[r+2],c=e[r+3],p=this.calculateAddress(h,c),a=this.getRegister(s);this.setAddressValue(p,a),t.pa+=4}else if(12==i){n=e[r+1],o=e[r+2],l=e[r+3],a=(t.pa+=4,this.getRegister(n)-this.getRegister(o));this.setRegister(l,a)}else if(13==i){n=e[r+1],o=e[r+2],p=this.getRegister(n),a=this.getAddressValue(p);this.setRegister(o,a),t.pa+=3}else if(14==i){n=e[r+1],o=e[r+2],p=this.getRegister(n),a=this.getAddressValue(p);this.setRegister(o,a),t.pa+=3}else if(15==i){n=e[r+1],o=e[r+2],a=this.getRegister(n),c=this.getRegister(o);this.setAddressValue(c,a),t.pa+=3}else{if(16!=i)return 255==i?t.pa+=1:log("未处理的执行".concat(i)),-1;n=e[r+1];t.pa=this.getRegister(n)}}},{key:"calculateAddress",value:function(e,t){return 256*t+e}},{key:"getAddressValue",value:function(e){var t=this.memory[e];return 256*this.memory[e+1]+t}},{key:"setAddressValue",value:function(e,t){var r=t>>8;this.memory[e]=255&t,this.memory[e+1]=r}},{key:"getRegister",value:function(e){var t=this.register;return 0==e?t.pa:1==e?t.a1:2==e?t.a2:3==e?t.a3:4==e?t.c1:5==e?t.f1:void log("未识别的寄存器")}},{key:"setRegister",value:function(e,t){var r=this.register;0==e?r.pa=t:1==e?r.a1=t:2==e?r.a2=t:3==e?r.a3=t:4==e?r.c1=t:5==e?r.f1=t:log("未识别的寄存器")}}]),r}();